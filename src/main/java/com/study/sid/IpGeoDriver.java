package com.study.sid;

import java.io.File;
import java.io.IOException;
import java.util.ArrayList;
import java.util.List;
import java.util.Scanner;
import java.util.concurrent.*;


import java.io.*;
import java.util.*;

/**
 * @version 1.01 2012-01-26
 * @author Cay Horstmann
 */
public class IpGeoDriver
{
    public static void main(String[] args) throws Exception
    {
        List<String> IP = Arrays.asList("162.193.86.15","73.214.22.65","54.200.64.73","54.200.64.73","54.200.64.73","50.148.114.238","107.208.1.206","54.200.64.73","66.249.90.50","4.15.82.98","66.249.90.24","54.200.64.73","172.56.11.180","184.17.198.88","49.197.43.225","54.200.64.73","80.156.37.148","54.200.64.73","66.249.90.42","193.63.62.188","76.88.90.208","203.217.174.17","66.249.90.42","96.55.198.86","54.200.64.73","66.249.90.24","198.217.64.23","107.133.217.56","103.66.97.154","54.200.64.73","54.200.64.73","54.200.64.73","64.80.70.132","68.202.45.236","54.200.64.73","50.184.239.215","54.200.64.73","81.151.199.230","54.200.64.73","54.200.64.73","54.200.64.73","67.242.60.132","89.10.217.227","54.200.64.73","71.41.128.122","54.200.64.73","54.200.64.73","54.200.64.73","23.242.51.224","54.200.64.73","54.200.64.73","66.249.90.42","54.200.64.73","40.139.142.126","209.183.153.14","131.78.174.229","195.212.29.190","172.56.28.66","174.219.8.196","66.249.90.24","172.27.15.88","54.200.64.73","70.192.64.84","202.8.30.6","67.11.11.14","54.200.64.73","98.248.60.48","70.199.141.183","72.14.231.193","66.249.90.42","54.200.64.73","54.200.64.73","37.222.1.45","162.123.17.85","54.200.64.73","54.200.64.73","54.200.64.73","67.1.223.236","54.200.64.73","4.35.175.53","54.200.64.73","54.200.64.73","54.200.64.73","66.249.90.42","66.249.90.24","198.208.104.51","4.15.82.98","54.200.64.73","31.50.34.77","66.249.90.42","66.249.90.42","109.84.3.60","54.200.64.73","54.200.64.73","70.211.8.128","208.54.86.224","54.200.64.73","165.125.178.10","50.159.78.181","54.200.64.73","66.215.133.10","24.196.27.96","54.200.64.73","54.200.64.73","66.249.90.42","54.200.64.73","37.216.243.236","54.200.64.73","54.200.64.73","24.13.64.223","54.200.64.73","54.200.64.73","54.200.64.73","81.175.27.4","73.93.143.98","54.200.64.73","54.200.64.73","54.200.64.73","54.200.64.73","54.200.64.73","54.200.64.73","12.28.118.130","213.180.176.86","54.200.64.73","54.200.64.73","108.185.16.72","54.200.64.73","65.78.142.55","54.200.64.73","54.200.64.73","12.198.67.2","74.139.253.29","54.200.64.73","189.27.7.47","54.200.64.73","54.200.64.73","68.4.60.122","54.200.64.73","54.200.64.73","54.200.64.73","86.141.118.68","93.168.28.203","195.171.20.10","66.249.90.42","121.128.132.214","98.122.19.112","54.200.64.73","54.200.64.73","54.200.64.73","54.200.64.73","54.200.64.73","73.235.65.157","54.200.64.73","160.3.166.152","54.200.64.73","54.200.64.73","54.200.64.73","77.56.89.209","5.155.165.157","54.200.64.73","107.77.164.42","54.200.64.73","54.200.64.73","93.222.222.182","66.183.10.98","92.24.12.134","54.200.64.73","172.56.13.200","54.200.64.73","218.226.193.229","76.105.52.9","54.200.64.73","109.65.31.195","54.200.64.73","54.200.64.73","54.200.64.73","54.200.64.73","184.148.226.119","24.22.74.218","80.241.89.66","108.201.65.172","54.200.64.73","76.206.194.34","54.200.64.73","54.200.64.73","54.200.64.73","54.200.64.73","54.200.64.73","54.200.64.73","24.64.181.139","67.169.25.41","73.235.65.157","54.200.64.73","54.200.64.73","54.200.64.73","207.6.166.136","66.249.90.50","54.200.64.73","54.200.64.73","54.200.64.73","89.98.34.220","54.200.64.73","54.200.64.73","54.200.64.73","54.200.64.73","73.254.98.204","54.200.64.73","54.200.64.73","99.114.248.207","50.128.248.57","98.246.97.26","72.104.28.231","54.200.64.73","54.200.64.73","66.87.152.8","54.200.64.73","183.89.50.135","66.87.123.98","54.200.64.73","54.200.64.73","54.200.64.73","74.74.167.175","54.200.64.73","23.252.49.230","54.200.64.73","50.39.190.123","96.246.235.72","54.200.64.73","54.200.64.73","54.200.64.73","97.81.105.184","54.200.64.73","66.249.90.42","54.200.64.73","185.66.16.91","54.200.64.73","54.200.64.73","54.200.64.73","54.200.64.73","54.200.64.73","109.166.136.220","54.200.64.73","54.200.64.73","54.200.64.73","54.200.64.73","54.200.64.73","66.87.99.138","54.200.64.73","54.200.64.73","54.200.64.73","54.200.64.73","54.200.64.73","54.200.64.73","54.200.64.73","67.190.163.54","108.238.180.15","54.200.64.73","54.200.64.73","92.110.63.106","54.200.64.73","97.94.182.182","172.56.11.76","66.249.90.42","54.200.64.73","73.93.143.98","175.43.242.147","66.249.90.42","108.252.141.120","72.201.13.138","108.34.165.35","24.237.87.233","70.71.76.90","54.200.64.73","54.200.64.73","54.200.64.73","54.200.64.73","54.200.64.73","66.87.84.22","96.50.181.138","54.200.64.73","66.249.90.42","98.155.5.225","104.175.75.92","54.200.64.73","54.200.64.73","73.104.46.168","54.200.64.73","54.200.64.73","54.200.64.73","54.200.64.73","54.200.64.73","54.200.64.73","54.200.64.73","54.200.64.73","98.248.60.48","54.200.64.73","54.200.64.73","66.215.116.238","194.239.94.33","54.200.64.73","54.200.64.73","54.200.64.73","54.200.64.73","54.200.64.73","54.200.64.73","54.200.64.73","24.114.105.164","54.200.64.73","75.111.59.83","67.6.222.92","54.200.64.73","54.200.64.73","177.228.87.107","54.200.64.73","31.208.194.19","73.82.46.38","54.200.64.73","54.200.64.73","54.200.64.73","54.200.64.73","69.77.253.66","66.140.191.91","54.200.64.73","202.8.30.6","71.84.112.123","172.56.39.186","172.56.7.61","24.114.41.180","66.249.90.50","72.130.91.102","54.200.64.73","54.200.64.73","178.167.11.148","107.77.224.201","54.200.64.73","73.140.8.170","54.200.64.73","85.107.218.82","96.55.78.73","176.35.77.162","54.200.64.73","99.67.23.120","66.249.90.50","204.153.60.5","172.56.21.194","54.200.64.73","66.249.90.50","70.65.69.44","80.94.146.48","128.177.161.142","43.250.8.19","54.200.64.73","54.200.64.73","50.154.186.192","84.9.73.199","54.200.64.73","54.200.64.73","54.200.64.73","54.200.64.73","24.68.10.72","205.197.242.161","173.164.91.193","205.197.242.168","54.200.64.73","75.132.242.83","24.19.169.50","23.16.60.33","66.87.143.64","216.105.213.183","54.200.64.73","172.3.140.66","104.7.9.125","209.29.196.10","54.200.64.73","172.58.24.177","87.236.139.90","54.200.64.73","108.233.164.161","54.200.64.73","54.200.64.73","54.200.64.73","54.200.64.73","98.237.147.138","208.10.51.69","75.91.155.60","54.200.64.73","69.181.59.237","162.197.0.194","54.200.64.73","173.218.47.2","134.114.223.250","208.70.36.6","70.210.69.109","54.200.64.73","78.17.229.91","107.184.15.58","54.200.64.73","54.200.64.73","54.200.64.73","99.117.103.47","54.200.64.73","54.200.64.73","54.200.64.73","54.200.64.73","66.249.90.42","54.200.64.73","54.200.64.73","24.207.101.103","54.200.64.73","54.200.64.73","192.243.80.182","203.217.174.17","95.7.210.221","54.200.64.73","2.139.157.110","88.151.159.194","81.253.17.193","54.200.64.73","84.94.159.219","202.8.30.6","54.200.64.73","174.19.225.57","54.200.64.73","54.200.64.73","194.243.41.3","66.249.90.42","109.168.24.22","172.58.139.156","76.100.153.58","54.200.64.73","73.235.65.157","54.200.64.73","54.200.64.73","54.200.64.73","54.200.64.73","54.200.64.73","54.200.64.73","54.200.64.73","202.8.30.6","66.249.90.42","54.200.64.73","54.200.64.73","174.141.152.59","203.217.174.17","54.200.64.73","54.200.64.73","54.200.64.73","54.200.64.73","110.74.221.93","70.193.211.253","72.201.3.194","71.209.213.81","54.200.64.73","118.128.22.13","66.249.90.42","66.249.90.24","70.213.6.217","66.249.90.24","169.253.194.1","54.200.64.73","73.147.122.162","54.200.64.73","83.12.188.100","72.130.83.196","54.200.64.73","54.200.64.73","54.200.64.73","54.200.64.73","54.200.64.73","54.200.64.73","54.200.64.73","174.57.183.30","54.200.64.73","54.200.64.73","45.3.25.170","166.137.219.187","54.200.64.73","172.56.6.100","24.217.43.1","54.200.64.73","66.249.90.50","104.231.55.38","54.200.64.73","54.200.64.73","70.209.199.35","68.145.38.219","54.200.64.73","66.249.90.42","218.23.40.14","54.200.64.73","99.225.145.46","162.231.145.140","54.200.64.73","54.200.64.73","54.200.64.73","54.200.64.73","54.200.64.73","54.200.64.73","97.126.13.120","54.200.64.73","54.200.64.73","54.200.64.73","54.200.64.73","54.200.64.73","188.200.129.2","54.200.64.73","70.212.32.28","54.200.64.73","5.179.82.4","54.200.64.73","54.200.64.73","69.64.222.138","54.200.64.73","212.38.86.82","68.184.77.243","54.200.64.73","54.200.64.73","95.83.249.7","54.200.64.73","54.200.64.73","54.200.64.73","54.200.64.73","73.235.65.157","54.200.64.73","187.107.22.43","198.179.214.2","54.200.64.73","173.245.66.56","205.201.71.72","54.200.64.73","107.77.197.218","68.4.177.53","54.200.64.73","76.183.223.4","54.200.64.73","54.200.64.73","50.68.194.16","54.200.64.73","64.120.47.68","54.200.64.73","98.234.211.198","108.77.233.176","70.211.5.50","68.229.12.83","184.151.37.136","174.7.91.249","96.55.193.122","73.168.79.101","54.200.64.73","67.160.194.113","50.53.45.228","54.200.64.73","54.200.64.73","71.28.76.230","54.200.64.73","216.4.56.168","54.200.64.73","54.200.64.73","54.200.64.73","24.114.68.72","91.120.31.146","54.200.64.73","107.77.224.172","54.200.64.73","54.200.64.73","67.182.252.240","54.200.64.73","54.200.64.73","54.200.64.73","198.177.95.129","54.200.64.73","66.249.90.42","54.200.64.73","54.200.64.73","54.200.64.73","64.46.5.215","125.238.199.89","54.200.64.73","54.200.64.73","54.200.64.73","54.200.64.73","54.200.64.73","98.234.49.186","54.200.64.73","154.20.24.55","54.200.64.73","70.45.109.30","54.200.64.73","198.99.32.5","54.200.64.73","54.200.64.73","54.200.64.73","98.164.239.158","54.200.64.73","54.200.64.73","54.200.64.73","54.200.64.73","54.200.64.73","213.97.211.26","54.200.64.73","70.209.97.132","97.99.198.163","63.155.56.138","54.200.64.73","54.200.64.73","54.200.64.73","54.200.64.73","54.200.64.73","12.179.104.81","54.200.64.73","71.209.213.81","54.200.64.73","54.200.64.73","50.168.89.167","23.16.92.28","209.170.125.226","67.188.206.53","160.44.230.236","54.200.64.73","76.217.147.95","107.77.212.183","54.200.64.73","66.249.90.50","54.200.64.73","97.102.165.93","69.42.14.143","208.92.185.20","54.200.64.73","85.106.112.76","54.200.64.73","54.200.64.73","54.200.64.73","54.200.64.73","54.200.64.73","54.200.64.73","54.200.64.73","54.200.64.73","70.120.169.181","154.20.24.55","54.200.64.73","123.231.126.119","54.200.64.73","100.39.58.142","54.200.64.73","54.200.64.73","23.16.60.33","208.54.36.219","172.56.15.129","54.200.64.73","89.204.154.253","66.87.97.107","54.200.64.73","216.52.195.58","54.200.64.73","45.49.237.239","54.200.64.73","66.87.120.214","54.200.64.73","50.65.223.113","54.200.64.73","54.200.64.73","54.200.64.73","54.200.64.73","180.191.130.169","54.200.64.73","73.70.3.53","75.170.133.10","54.200.64.73","54.200.64.73","12.153.99.131","67.174.216.76","54.200.64.73","54.200.64.73","192.55.54.43","68.193.101.41","109.103.81.238","54.200.64.73","50.67.15.155","72.180.246.229","54.200.64.73","220.255.101.65","54.200.64.73","111.223.89.3","108.252.141.120","108.81.185.98","54.200.64.73","108.185.170.10","54.200.64.73","204.14.96.246","54.200.64.73","23.233.104.57","66.87.119.71","172.91.84.103","107.77.172.25","107.17.38.201","54.200.64.73","172.248.142.119","54.200.64.73","54.200.64.73","99.127.5.5","174.34.218.21","185.69.144.125","66.249.90.24","203.217.174.17","72.92.31.249","54.200.64.73","23.123.140.210","112.207.120.36","176.76.241.46","108.77.228.177","54.200.64.73","23.16.60.33","66.249.90.42","54.200.64.73","54.200.64.73","54.200.64.73","70.71.116.184","76.88.76.169","68.224.178.98","76.169.223.199","66.87.120.252","66.249.90.50","75.43.36.78","54.200.64.73","50.136.235.164","66.190.231.8","173.188.184.210","76.8.212.219","54.200.64.73","212.179.247.80","54.200.64.73","66.249.90.42","108.216.52.189","66.249.90.42","66.87.120.214","54.200.64.73","54.200.64.73","66.87.145.197","54.200.64.73","82.72.234.33","50.92.115.68","54.200.64.73","104.187.151.135","54.200.64.73","54.200.64.73","54.200.64.73","71.189.43.21","75.172.139.96","66.249.90.50","66.249.90.42","54.200.64.73","75.22.129.29","54.200.64.73","54.200.64.73","173.224.181.130","54.200.64.73","70.120.236.32","72.235.198.161","108.45.101.23","174.197.2.83","66.249.90.50","54.200.64.73","71.10.27.34","54.200.64.73","66.249.90.42","54.200.64.73","54.200.64.73","54.200.64.73","68.144.12.70","54.200.64.73","54.200.64.73","54.200.64.73","54.200.64.73","54.200.64.73","54.200.64.73","24.17.26.42","67.183.105.85","54.200.64.73","54.200.64.73","54.200.64.73","54.200.64.73","108.201.65.172","54.200.64.73","54.200.64.73","173.11.66.197","104.34.122.6","54.200.64.73","79.136.15.50","54.200.64.73","54.200.64.73","76.7.150.237","54.200.64.73","54.200.64.73","54.200.64.73","123.51.163.48","107.217.233.69","72.180.246.229","182.77.55.209","75.65.206.236","66.249.90.42","54.200.64.73","172.112.88.223","216.151.180.66","99.8.140.149","66.249.90.42","65.31.212.141","87.69.180.249","54.200.64.73","54.200.64.73","54.200.64.73","54.200.64.73","174.67.207.211","73.49.34.185","218.247.15.51","54.200.64.73","63.211.20.78","54.200.64.73","68.230.68.175","54.200.64.73","24.116.93.36","81.110.89.67","66.191.54.20","54.200.64.73","172.58.105.54","66.249.90.42","73.109.58.134","184.21.4.42","66.249.90.42","54.200.64.73","172.56.5.16","108.180.144.111","97.101.147.209","54.200.64.73","54.200.64.73","172.2.102.177","54.200.64.73","66.87.133.208","54.200.64.73","175.223.32.185","66.249.90.24","66.249.90.42","67.83.32.180","98.112.227.125","81.144.233.245","202.8.30.6","54.200.64.73","54.200.64.73","54.200.64.73","54.200.64.73","54.200.64.73","68.7.119.81","98.30.78.42","54.200.64.73","97.89.96.159","54.200.64.73","54.200.64.73","66.249.90.42","70.211.66.124","142.255.121.12","54.200.64.73","54.200.64.73","54.200.64.73","54.200.64.73","172.56.6.141","54.200.64.73","118.92.133.134","54.200.64.73","54.200.64.73","66.87.68.80","172.91.135.208","54.200.64.73","96.255.9.12","66.43.191.218","172.58.155.9","70.193.137.55","107.204.29.39","54.200.64.73","216.0.116.5","54.200.64.73","54.200.64.73","68.12.3.88","50.202.203.203","54.200.64.73","73.109.58.134","122.58.138.97","54.200.64.73","54.200.64.73","73.15.154.104","66.87.67.180","54.200.64.73","204.176.100.28","66.249.90.42","72.188.96.38","54.200.64.73","54.200.64.73","213.212.5.187","68.231.66.115","70.209.21.51","54.200.64.73","174.113.192.229","54.200.64.73","54.200.64.73","54.200.64.73","66.249.90.42","66.249.90.42","107.137.202.138","54.200.64.73","66.249.90.42","66.249.90.42","99.104.187.86","66.249.90.42","54.200.64.73","76.168.159.22","208.54.36.169","66.87.124.228","50.45.163.183","54.200.64.73","80.188.116.141","68.96.160.176","178.197.230.225","54.200.64.73","54.200.64.73","104.35.232.81","54.200.64.73","75.85.181.59","85.242.199.26","172.56.15.24","68.108.71.187","54.200.64.73","66.249.90.42","54.200.64.73","66.77.117.5","66.249.90.42","66.249.90.42","209.148.36.36","54.200.64.73","54.200.64.73","54.200.64.73","54.200.64.73","70.212.38.28","24.5.81.88","54.200.64.73","54.200.64.73","23.243.46.204","54.200.64.73","208.54.87.234","54.200.64.73","24.114.68.72","54.200.64.73","54.200.64.73","54.200.64.73","54.200.64.73","54.200.64.73","115.111.128.46","77.31.47.64","50.25.46.68","141.6.11.25","178.135.82.160","54.200.64.73","54.200.64.73","54.200.64.73","54.200.64.73","71.93.144.241","141.0.96.66","172.58.104.230","54.200.64.73","76.123.115.229","108.250.227.53","78.54.161.121","54.200.64.73","54.200.64.73","216.163.13.116","64.203.38.15","70.211.5.50","97.78.163.145","50.192.49.5","212.50.124.95","108.18.145.14","107.128.208.171","54.200.64.73","80.12.34.60","98.202.156.209","54.200.64.73","54.200.64.73","172.58.40.102","54.200.64.73","54.200.64.73","24.11.52.38","54.200.64.73","54.200.64.73","54.200.64.73","54.200.64.73","104.0.124.130","54.200.64.73","12.189.199.68","70.211.2.231","54.200.64.73","54.200.64.73");
        ExecutorService pool = Executors.newCachedThreadPool();

        IpResolver counter = new IpResolver(IP, pool);
        Future<Integer> result = pool.submit(counter);

        try
        {
            System.out.println(result.get() + " matching ip's.");
        }
        catch (ExecutionException e)
        {
            e.printStackTrace();
        }
        catch (InterruptedException e)
        {
        }
        pool.shutdown();

        int largestPoolSize = ((ThreadPoolExecutor) pool).getLargestPoolSize();
        System.out.println("largest pool size=" + largestPoolSize);
    }
}

/**
 * This task counts the files in a directory and its subdirectories that contain a given keyword.
 */
class IpResolver implements Callable<Integer>
{
    private List<String> IP;
    private String keyword;
    private ExecutorService pool;
    private int count;

    /**
     * Constructs a IpResolver
     * @param IP the list of IP's to look for
     * @param pool the thread pool for submitting subtasks
     */
    public IpResolver(List<String> IP, ExecutorService pool)
    {
        this.IP = IP;
        this.pool = pool;
    }

    public Integer call()
    {
        count = 0;
        try {
            List<Future<Integer>> results = new ArrayList<>();

            for (String ip : IP){
                IpGeoClient ipGeoClient = new IpGeoClient(ip);
                try {
                    ipGeoClient.response();
                } catch (IOException e) {
                    e.printStackTrace();
                }
            }


            for (Future<Integer> result : results)
                try
                {
                    count += result.get();
                }
                catch (ExecutionException e)
                {
                    e.printStackTrace();
                }
        }
        catch (InterruptedException e)
        {
        }
        return count;
    }

}
