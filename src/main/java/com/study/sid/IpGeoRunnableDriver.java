package com.study.sid;

import java.util.ArrayList;
import java.util.Arrays;
import java.util.List;
import java.util.Random;
import java.util.concurrent.*;

/**
 * Created by srathi on 7/25/16.
 */
public class IpGeoRunnableDriver {

    public static void main(String[] args) throws InterruptedException, ExecutionException {
        long start = System.currentTimeMillis();
        //int  n = rand.nextInt(20 + 1) + 30;
        int NTHREADS = 10;
        List<List<String>> IPS = new ArrayList<List<String>>();
        List<String> IP1 = Arrays.asList("66.87.103.140", "108.206.153.160", "71.223.134.31", "172.56.8.160", "100.34.228.249", "72.240.117.163", "66.193.77.50", "99.228.2.234", "152.132.9.2", "97.86.32.28", "76.112.188.105", "70.194.204.193", "98.226.29.39", "192.193.172.11", "174.111.196.177", "66.56.15.121", "107.77.194.201", "213.221.235.105", "12.148.247.22", "104.61.50.105", "199.189.77.50", "24.21.8.10", "205.250.99.85", "128.177.161.139", "47.20.249.100", "173.9.108.53", "75.171.101.1", "72.143.232.139", "138.229.201.246", "170.88.180.1", "74.94.71.53", "24.181.105.44", "142.255.124.69", "76.195.56.245", "207.199.235.79", "197.226.33.95", "162.200.104.73", "74.212.165.250", "73.139.202.18", "198.204.141.208", "47.19.122.101", "72.165.252.218", "107.77.234.101", "108.202.216.176", "172.56.15.112", "68.0.176.224", "24.244.72.53");
        List<String> IP2 = Arrays.asList("40.129.107.147", "167.187.101.240", "160.84.253.236", "82.164.1.250", "67.79.188.18", "24.43.232.195", "96.237.241.216", "107.77.235.116", "67.176.246.58", "73.131.186.246", "24.224.38.90", "99.248.168.19", "54.200.64.73", "76.185.59.94", "67.207.36.139", "24.33.132.177", "66.87.64.117", "66.87.133.66", "184.66.105.45", "99.255.29.108", "82.34.223.141", "66.115.218.158", "66.134.53.178", "71.181.133.205", "173.160.161.21", "71.206.187.235", "108.248.93.81", "66.87.152.232", "24.65.34.226", "172.58.153.9", "70.193.248.180", "209.171.47.7", "70.15.61.231", "208.54.35.226", "50.203.106.162", "24.114.101.202", "74.100.145.214", "66.249.90.50", "71.87.8.130", "204.14.191.89", "198.153.241.140", "50.200.201.162", "155.201.34.13", "207.255.131.83", "100.4.160.2", "161.225.196.111", "97.88.241.218", "24.216.80.118", "142.240.200.10", "96.254.123.179");
        List<String> IP3 = Arrays.asList("99.190.106.7", "198.185.18.207", "67.191.26.159", "138.162.0.41", "109.76.25.181", "99.3.28.51", "70.215.131.239", "151.243.72.204", "199.168.151.169", "172.56.16.114", "108.248.196.230", "121.54.2.146", "104.247.43.2", "198.45.3.32", "66.64.226.222", "72.44.149.244", "68.87.42.110", "177.22.145.133", "54.200.64.73", "32.214.136.70", "142.197.214.169", "47.17.213.37", "198.31.196.18", "70.166.32.88", "70.70.36.188", "75.164.150.243", "66.87.120.195", "70.214.109.149", "76.0.179.231", "67.224.154.12", "174.52.199.93", "76.21.116.236", "66.87.102.2", "5.68.159.39", "54.200.64.73", "192.107.142.144", "76.21.77.92", "68.119.167.70", "66.215.222.42", "76.174.94.167", "24.178.219.174", "50.176.232.188", "70.195.193.53", "66.87.82.143", "85.115.54.201", "73.18.26.202", "160.147.102.73", "66.87.80.20", "50.148.206.100");
        List<String> IP4 = Arrays.asList("2.221.89.250", "23.24.78.171", "209.91.198.53", "70.73.120.36", "68.53.196.155", "162.195.37.126", "216.4.56.143", "24.153.136.154", "207.250.87.150", "172.58.233.141", "63.142.117.240", "50.100.139.161", "142.162.132.254", "73.209.54.180", "66.161.240.178", "208.103.116.226", "141.8.64.158", "75.156.17.57", "24.248.60.130", "199.59.135.5", "70.208.133.182", "66.249.90.24", "73.241.193.167", "50.5.137.223", "70.212.50.11", "68.187.140.16", "204.86.209.200", "12.106.204.134", "204.64.62.132", "54.200.64.73", "198.53.249.29", "204.80.61.132", "70.193.110.129", "69.114.22.30", "50.199.108.233", "184.68.82.250", "209.207.38.70", "64.72.76.138", "172.9.31.21", "67.200.130.246", "70.193.141.0", "73.72.41.174", "170.74.248.4", "78.87.13.161", "216.51.230.208", "208.54.5.174", "73.173.125.237", "66.110.218.171", "70.193.63.116", "205.197.242.151");
        List<String> IP5 = Arrays.asList("134.174.110.8", "66.87.77.96", "76.68.81.210", "69.174.87.52", "144.89.7.122", "50.100.236.187", "172.58.104.62", "67.0.98.89", "142.161.106.189", "69.241.116.10", "174.53.58.23", "66.177.95.96", "96.95.220.76", "91.228.245.254", "173.87.104.184", "209.254.122.225", "70.208.225.108", "70.173.104.66", "199.48.82.75", "75.17.89.216", "72.239.9.245", "168.244.4.53", "162.250.162.8", "184.149.42.41", "75.99.200.130", "174.110.233.94", "70.193.74.146", "205.197.242.171", "70.210.32.12", "12.228.240.2", "104.14.105.172", "107.15.41.187", "80.203.126.44", "97.87.97.243", "75.149.96.81", "209.94.176.249", "172.58.171.15", "141.8.143.189", "81.142.163.129", "209.130.208.154", "32.208.206.251", "71.226.241.235", "90.220.27.27", "217.243.129.235", "199.169.200.4", "66.87.121.147", "155.8.29.0", "73.24.96.7", "96.254.27.251", "108.214.108.222");
        List<String> IP6 = Arrays.asList("66.249.90.42", "94.122.111.117", "172.58.144.248", "159.246.20.2", "97.81.37.32", "69.157.117.84", "96.32.137.237", "204.235.114.162", "198.175.199.13", "24.177.250.137", "107.77.205.109", "70.212.0.162", "173.226.16.228", "54.200.64.73", "108.171.132.172", "96.81.201.201", "173.221.89.26", "108.49.17.237", "216.179.118.67", "98.224.227.13", "173.79.138.64", "89.134.85.164", "209.129.16.5", "117.193.60.148", "50.43.15.50", "38.88.10.250", "67.191.212.35", "207.225.131.10", "208.117.106.37", "173.180.217.5", "198.133.139.5", "173.172.19.84", "50.253.3.65", "74.243.118.23", "65.216.158.132", "206.18.191.167", "65.216.158.132", "142.161.235.84", "173.26.31.165", "66.249.90.42", "24.76.187.193", "204.76.30.253", "70.29.250.184", "167.219.88.140", "71.164.190.129", "207.155.67.16", "63.100.172.20", "73.13.154.182", "205.156.36.57", "73.137.234.97");
        List<String> IP7 = Arrays.asList("96.41.11.220", "187.209.65.169", "66.87.68.41", "72.201.168.83", "198.137.185.16", "24.171.194.216", "107.77.202.65", "96.28.13.146", "68.83.220.128", "65.213.99.254", "108.64.197.220", "12.149.74.18", "67.161.201.116", "107.77.216.50", "199.167.109.250", "107.140.29.144", "54.200.64.73", "75.158.143.100", "172.218.70.246", "107.77.160.52", "75.109.152.129", "24.35.47.24", "96.89.143.178", "216.135.16.62", "71.230.127.34", "172.56.35.66", "107.77.207.106", "98.193.100.190", "99.182.7.96", "202.62.16.70", "190.245.229.72", "98.226.138.36", "75.150.153.173", "65.158.129.2", "68.115.59.9", "64.33.244.37", "66.176.15.100", "70.208.205.10", "24.211.214.254", "64.203.202.74", "66.249.90.24", "172.91.231.32", "66.87.81.113", "73.68.238.112", "204.238.198.6", "167.102.191.18", "54.200.64.73", "173.174.105.59", "74.113.89.226", "70.56.183.93");
        List<String> IP8 = Arrays.asList("209.155.32.130", "136.167.36.225", "82.71.33.75", "69.138.58.173", "70.192.134.134", "184.184.176.153", "76.118.39.206", "54.200.64.73", "202.8.30.6", "140.147.179.128", "202.8.30.6", "66.249.90.42", "202.8.30.6", "104.162.116.23", "184.151.36.234", "148.8.100.253", "66.87.82.234", "147.241.150.2", "97.95.78.48", "158.111.236.42", "199.125.16.11", "99.253.77.157", "64.150.11.24", "166.137.96.105", "24.20.111.57", "136.160.163.211", "68.156.159.10", "107.77.216.142", "170.72.145.115", "142.203.1.9", "64.141.193.30", "107.77.235.81", "207.71.136.190", "66.249.90.50", "190.144.12.83", "12.148.189.25", "108.171.132.164", "96.90.76.74", "107.77.207.183", "174.134.232.87", "24.114.76.183", "107.77.217.117", "73.168.93.57", "202.8.30.6", "50.80.76.189", "67.163.141.39", "54.200.64.73", "209.172.72.146", "128.151.186.35", "66.249.90.42");
        List<String> IP9 = Arrays.asList("70.194.5.74", "98.173.235.74", "70.198.70.164", "213.14.117.164", "99.93.74.84", "209.91.105.34", "172.58.56.10", "67.189.120.86", "65.31.106.154", "69.42.189.114", "107.213.73.252", "37.202.95.196", "107.77.236.71", "173.52.86.13", "100.38.236.233", "96.241.133.208", "63.74.218.2", "199.212.81.64", "65.29.144.48", "47.222.43.69", "173.206.136.38", "98.110.188.136", "108.54.199.62", "143.120.13.160", "104.14.105.172", "90.212.115.59", "107.77.164.22", "107.77.236.112", "167.183.216.10", "161.11.133.16", "70.208.130.213", "108.230.139.119", "142.137.20.26", "174.126.189.113", "108.219.96.98", "152.10.145.175", "12.1.179.18", "97.35.192.62", "66.87.73.245", "24.34.181.179", "128.172.48.27", "149.168.240.7", "70.195.74.212", "99.249.230.222", "98.224.59.213", "74.8.48.210", "24.173.172.194", "172.97.252.212", "66.87.80.39", "69.42.183.10");
        List<String> IP10 = Arrays.asList("71.57.150.35", "68.61.238.2", "172.56.28.226", "96.80.1.89", "50.245.74.33", "128.211.254.158", "173.220.12.67", "69.124.153.222", "96.84.255.185", "207.236.187.143", "71.12.174.97", "75.172.24.131", "69.176.104.226", "66.87.103.16", "207.38.166.19", "174.62.207.116", "164.143.240.34", "138.162.0.43", "76.104.115.30", "70.194.98.205", "70.208.71.128", "24.187.55.248", "61.6.238.203", "98.109.104.13", "165.155.110.4", "75.177.99.123", "108.80.29.169", "65.196.116.115", "189.59.213.98", "199.192.1.7", "97.98.144.204", "208.84.184.239", "66.249.90.50", "50.75.244.86", "1.32.75.103", "74.203.101.252", "68.188.47.42", "68.100.241.213", "173.251.20.242", "88.190.203.74", "172.58.152.220", "66.86.95.150", "73.99.93.64", "45.16.251.21", "54.200.64.73", "172.58.41.117", "174.219.0.124", "184.89.218.206", "47.54.11.2", "66.38.106.206");
        List<String> IP11 = Arrays.asList("66.163.12.241", "199.84.234.201", "65.26.22.59", "45.16.215.87", "107.194.85.31", "159.153.4.92", "216.113.24.1", "70.194.72.175", "12.15.146.254", "70.126.231.97", "12.180.225.130", "187.237.14.202", "23.127.81.126", "65.24.84.56", "65.116.75.234", "68.62.200.55", "67.79.218.130", "69.242.37.119", "24.251.102.127", "70.193.128.142", "54.203.91.69", "172.91.109.45", "108.213.112.245", "23.233.246.225", "199.123.74.117", "24.248.16.3", "68.186.36.147", "70.199.3.2", "67.55.235.233", "50.160.159.196", "184.152.163.75", "74.206.122.29", "54.200.64.73", "24.227.104.34", "75.129.2.47", "192.236.31.54", "208.95.49.246", "198.102.155.115", "72.198.165.98", "36.231.83.217", "54.200.64.73", "104.55.138.116", "184.151.36.241", "50.45.20.14", "66.249.90.50", "64.39.149.224", "66.87.123.143", "159.53.78.143", "97.101.196.129", "73.181.53.225");
        List<String> IP12 = Arrays.asList("72.143.233.214", "174.71.205.3", "73.237.66.101", "66.195.168.66", "63.72.211.241", "74.93.18.140", "198.72.78.1", "24.194.164.153", "65.66.197.218", "70.192.132.19", "208.180.216.106", "73.32.74.42", "173.55.253.118", "207.219.93.47", "12.30.28.14", "24.51.32.101", "173.95.189.58", "71.187.131.17", "74.113.119.1", "98.85.26.81", "202.8.30.6", "202.8.30.6", "166.216.159.124", "202.8.30.6", "202.8.30.6", "202.8.30.6", "149.101.1.118", "172.56.28.109", "12.6.136.148", "71.203.45.4", "66.249.90.42", "203.217.174.17", "174.57.25.79", "76.97.75.9", "67.167.91.142", "73.168.93.57", "24.96.226.81", "75.131.17.76", "104.178.140.43", "173.50.90.111", "172.58.59.133", "66.87.122.246", "208.90.105.121", "108.180.194.56", "70.28.77.142", "66.69.232.216", "97.67.101.130", "66.25.187.232", "66.87.116.147", "104.53.241.116");
        List<String> IP13 = Arrays.asList("74.199.109.154", "47.20.9.136", "12.145.2.130", "202.8.30.6", "98.226.224.142", "205.213.208.250", "96.42.202.168", "178.167.184.31", "96.252.89.99", "54.200.64.73", "189.238.53.187", "69.123.132.71", "70.193.111.193", "107.207.237.171", "66.87.79.118", "204.101.190.117", "70.210.225.139", "69.21.111.234", "70.193.133.32", "174.91.212.131", "174.91.4.94", "98.160.81.42", "192.231.133.247", "96.21.155.210", "71.164.166.242", "67.191.208.223", "72.68.69.64", "24.72.49.199", "73.184.67.171", "66.249.90.42", "24.114.80.9", "73.188.191.81", "64.134.140.120", "172.56.3.101", "12.185.110.26", "66.244.236.194", "73.201.46.6", "66.161.140.2", "160.79.85.34", "209.137.209.180", "12.12.212.245", "71.196.78.145", "172.56.21.128", "66.87.128.176", "108.253.42.81", "162.252.126.37", "205.197.242.145", "189.243.192.247", "54.200.64.73", "162.224.157.63");
        List<String> IP14 = Arrays.asList("97.93.130.134", "73.77.244.66", "208.88.204.21", "70.196.208.63", "66.148.171.250", "108.216.111.73", "136.2.1.169", "66.87.133.144", "73.172.207.135", "202.8.30.6", "192.174.72.128", "73.22.167.190", "98.201.110.229", "202.8.30.6", "202.8.30.6", "71.205.58.24", "66.249.90.42", "98.182.30.206", "67.190.221.98", "172.56.4.57", "168.168.33.250", "203.217.174.17", "209.121.152.46", "223.72.98.133", "181.197.19.109", "203.217.174.17", "50.232.182.123", "170.63.57.55", "202.8.30.6", "70.212.3.247", "98.222.7.248", "107.77.211.19", "98.14.187.73", "71.96.229.6", "71.238.82.221", "73.204.100.204", "50.170.184.228", "172.58.200.187", "203.217.174.17", "202.8.30.6", "208.99.241.102", "202.8.30.6", "172.73.234.166", "160.147.102.73", "68.8.156.229", "98.218.208.65", "97.86.98.70", "73.211.92.132", "98.192.251.66", "72.91.106.13");
        IPS.add(IP1);
        IPS.add(IP2);
        IPS.add(IP3);
        IPS.add(IP4);
        IPS.add(IP5);
        IPS.add(IP6);
        IPS.add(IP7);
        IPS.add(IP8);
        IPS.add(IP9);
        IPS.add(IP10);
        IPS.add(IP11);
        IPS.add(IP12);
        IPS.add(IP13);
        IPS.add(IP14);
        for (List<String> IP : IPS) {
        List<Callable<IpGeoCallable>> tasks = new ArrayList<Callable<IpGeoCallable>>();
        List<Future<IpGeoCallable>> future = new ArrayList<Future<IpGeoCallable>>();
        ExecutorService pool = Executors.newFixedThreadPool(NTHREADS);
        //IpGeoCallableAll all = new IpGeoCallableAll(IP);
        //Future<Integer> result = pool.submit(all);
            for (String ip : IP)
                tasks.add(new IpGeoCallable(ip));
            future = pool.invokeAll(tasks);
            for (Future<IpGeoCallable> f : future) {
                f.get();
            }
            pool.shutdown();
            System.out.println("Pool is shutting down");
        }
        long end = System.currentTimeMillis();
        System.out.println("Took : " + ((end - start) / 1000));
    }

}



